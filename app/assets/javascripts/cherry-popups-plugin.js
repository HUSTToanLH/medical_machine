(function($,CherryJsCore){var methods={init:function(options){var settings={call:function(){}};return this.each(function(){var $this=$(this),$window=$(window),popupSettings=$this.data('popup-settings'),popupsLocalStorageData=getLocalStorageData()||{},popupAvailable=popupsLocalStorageData[popupSettings.id]||'enable',$subscribeForm=$('.cherry-popup-subscribe',$this),$showAgainCheck=$('.cherry-popup-show-again-check',$this),$subscribeFormMessage=null,cherrySubscribeFormAjax=null,subscribeFormAjaxId='cherry_subscribe_form_ajax';if(options){$.extend(settings,options);}
(function(){if('disable'===popupAvailable){$this.remove();return false;}
if(!popupsLocalStorageData.hasOwnProperty(popupSettings.id)){popupsLocalStorageData[popupSettings.id]='enable';}
setLocalStorageData(popupsLocalStorageData);switch(popupSettings.use){case'open-page':addOpenEventsFunction();break;case'close-page':addCloseEventsFunction();break;}
if('false'===popupSettings['show-once']){checkEvents();}else{$showAgainCheck.remove();popupsLocalStorageData[popupSettings.id]='disable';setLocalStorageData(popupsLocalStorageData);}
closePopupEvent(popupSettings['load-open-delay']);if($subscribeForm[0]){$subscribeFormMessage=$('.cherry-popup-subscribe__message',$subscribeForm);cherrySubscribeFormAjax=new CherryJsCore.CherryAjaxHandler({handlerId:subscribeFormAjaxId,successCallback:subscribeFormAjaxSuccessCallback});$subscribeForm.on('click','.cherry-popup-subscribe__submit',subscribeFormAjax);}})();function addOpenEventsFunction(){switch(popupSettings['open-appear-event']){case'page-load':pageLoadEvent(popupSettings['load-open-delay']);break;case'user-inactive':userInactiveEvent(popupSettings['inactive-time']);break;case'scroll-page':scrollPageEvent(popupSettings['page-scrolling-value']);break;}}
function addCloseEventsFunction(){switch(popupSettings['close-appear-event']){case'outside-viewport':viewportLeaveEvent();break;case'page-focusout':pageFocusoutEvent();break;}}
function closePopupEvent(){var timeout=null;$this.on('click','.cherry-popup-close-button',function(event){var button=event.currentTarget,$parentPopup=$(button).closest('.cherry-popup');$this.toggleClass('hide-animation show-animation');clearTimeout(timeout);timeout=setTimeout(function(){$parentPopup.remove();},500);});$this.on('click','.cherry-popup-overlay',function(event){var overlay=event.currentTarget,$parentPopup=$(overlay).closest('.cherry-popup');$this.toggleClass('hide-animation show-animation');clearTimeout(timeout);timeout=setTimeout(function(){$parentPopup.remove();},500);});}
function checkEvents(){$this.on('click','.cherry-popup-show-again-check',function(event){var check=event.currentTarget,popupsLocalStorageData=getLocalStorageData()||{};if(!$(check).hasClass('checked')){$(check).addClass('checked');popupsLocalStorageData[popupSettings.id]='disable';}else{$(check).removeClass('checked');popupsLocalStorageData[popupSettings.id]='enable';}
setLocalStorageData(popupsLocalStorageData);});}
function pageLoadEvent(openDelay){var delay=+openDelay||0;delay=delay*1000;$(document).on('ready',function(){setTimeout(function(){$this.addClass('show-animation');},delay);});}
function userInactiveEvent(inactiveDelay){var delay=+inactiveDelay||0,isInactive=true;delay=delay*1000;setTimeout(function(){if(isInactive){$this.addClass('show-animation');}},delay);$(document).on('click focus resize keyup scroll',function(){isInactive=false;});}
function scrollPageEvent(scrollingValue){var scrolledValue=+scrollingValue||0;$(window).on('scroll.cherryPopupScrollEvent resize.cherryPopupResizeEvent',function(){var $window=$(window),windowHeight=$window.height(),documentHeight=$(document).height(),scrolledHeight=documentHeight- windowHeight,scrolledProgress=Math.max(0,Math.min(1,$window.scrollTop()/ scrolledHeight ) ) * 100;if(scrolledProgress>=scrolledValue){$(window).off('scroll.cherryPopupScrollEvent resize.cherryPopupResizeEvent');$this.addClass('show-animation');}}).trigger('scroll.cherryPopupScrollEvent');}
function viewportLeaveEvent(){var pageY=0;$(document).on('mouseleave','body',function(event){if(!$('.open-page-type')[0]){pageY=event.pageY- $window.scrollTop();if(0>pageY){$this.addClass('show-animation');}}});}
function pageFocusoutEvent(){$(window).on('blur',function(){if(!$('.open-page-type')[0]){$this.addClass('show-animation');}});}
function subscribeFormAjax(){var $input=$('.cherry-popup-subscribe__input',$subscribeForm),inputValue=$input.val();cherrySubscribeFormAjax.sendData({'mail':inputValue});}
function subscribeFormAjaxSuccessCallback(data){var successType=data.type,message=data.message||'',timeout=null;if('success'===successType){$subscribeFormMessage.addClass('success-type');}
$('span',$subscribeFormMessage).html(message);$subscribeFormMessage.slideDown(300);timeout=setTimeout(function(){$subscribeFormMessage.slideUp(300,function(){$subscribeFormMessage.removeClass('success-type');clearTimeout(timeout);});},3000);}
function getLocalStorageData(){try{return JSON.parse(localStorage.getItem('popupsLocalStorageData'));}catch(e){return false;}}
function setLocalStorageData(object){try{localStorage.setItem('popupsLocalStorageData',JSON.stringify(object));}catch(e){return false;}}});},destroy:function(){},update:function(){}};$.fn.cherryPopupsPlugin=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if('object'===typeof method||!method){return methods.init.apply(this,arguments);}else{$.error('Method with name '+ method+' is not exist for jQuery.cherryPopupsPlugin');}};})(jQuery,window.CherryJsCore);